---
layout: post
title: üëç Likes - A decentralized social network in a single HTML tag
tags: [html, programming, web, cloudflare, replies, likes]
date: 2024-03-20 18:39:19 -060
---

<blockquote>
  <p>"Everything is made up and the points don't matter."</p>
  <p style="font-style:initial;padding-left:2rem;">- Drew Carey, <i>Who's Line Is it Anyway?</i></p>
</blockquote>

<h2 style="font-family:sans-serif;">Just click like:</h2>
<img style='cursor:pointer;height:24px;'
  referrerpolicy='no-referrer-when-downgrade'
  src='https://likes.catskull.net'
  onclick="fetch('https://likes.catskull.net', {method:'POST',referrerPolicy:'no-referrer-when-downgrade'}).then(()=>this.src='https://likes.catskull.net'.split('?')[0]+'?t='+Date.now())"
  onmouseover="this.src='data:image/svg+xml;base64,CiAgCQkJPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHdpZHRoPSI2NCI+CiAgICAgICAgICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ3aGl0ZSI+PC9yZWN0PgogIAkJCSAgPHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7wn5GNIExpa2UhPC90ZXh0PgogIAkJCTwvc3ZnPgogIAkJ'"
  onmouseout="this.src='https://likes.catskull.net?t=0'"
>

<h2 style="font-family:sans-serif;">How?</h2>

{% capture compiled_preview %}
{%comment%}
```html
<img style="cursor:pointer;height:24px;" 
  referrerpolicy="no-referrer-when-downgrade"   
  src="https://likes.catskull.net?t=0"   
  onclick="fetch('https://likes.catskull.net',{method:'POST',referrerPolicy:'no-referrer-when-downgrade'}).then(()=>this.src='https://likes.catskull.net'.split('?')[0]+'?t='+Date.now())" 
  onmouseover="this.src='data:image/svg+xml;base64,CiAgCQkJPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHdpZHRoPSI2NCI+CiAgICAgICAgICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ3aGl0ZSI+PC9yZWN0PgogIAkJCSAgPHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7wn5GNIExpa2UhPC90ZXh0PgogIAkJCTwvc3ZnPgogIAkJ'"
  onmouseout="this.src='https://likes.catskull.net?t=0'"
/>
```
{%endcomment%}
<div class="highlight highlight-text-html-basic"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">img</span> <span class="pl-c1">style</span>="<span class="pl-s">cursor:pointer;height:24px;</span>" 
  <span class="pl-c1">referrerpolicy</span>="<span class="pl-s">no-referrer-when-downgrade</span>"   
  <span class="pl-c1">src</span>="<span class="pl-s">https://likes.catskull.net?t=0</span>"   
  <span class="pl-c1">onclick</span>="<span class="pl-s">fetch('https://likes.catskull.net',{method:'POST',referrerPolicy:'no-referrer-when-downgrade'}).then(()=&gt;this.src='https://likes.catskull.net'.split('?')[0]+'?t='+Date.now())</span>" 
  <span class="pl-c1">onmouseover</span>="<span class="pl-s">this.src='data:image/svg+xml;base64,CiAgCQkJPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHdpZHRoPSI2NCI+CiAgICAgICAgICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ3aGl0ZSI+PC9yZWN0PgogIAkJCSAgPHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7wn5GNIExpa2UhPC90ZXh0PgogIAkJCTwvc3ZnPgogIAkJ'</span>"
  <span class="pl-c1">onmouseout</span>="<span class="pl-s">this.src='https://likes.catskull.net?t=0'</span>"
/&gt;</pre></div>
{% endcapture %}
{% include code.html
  content=compiled_preview
  filename="Put this HTML anywhere:"
  copy=true
%}

<h2 style="font-family:sans-serif;">WTF</h2>

<p>Any <code class="language-plaintext highlighter-rouge">GET</code> request to <code class="language-plaintext highlighter-rouge">https://likes.catskull.net</code> will return an SVG with the number of likes for the URL in the <code class="language-plaintext highlighter-rouge">Referer</code><a href="https://en.wikipedia.org/wiki/HTTP_referer">[sic]</a> header. This page is rendered if no URL is present.</p>

<p>Any <code class="language-plaintext highlighter-rouge">POST</code> request to <code class="language-plaintext highlighter-rouge">https://likes.catskull.net</code> will increment the number of likes for the <code class="language-plaintext highlighter-rouge">Referer</code> URL and return an SVG with the new number of likes.</p>

<h2 style="font-family:sans-serif;">Why?</h2>

<p>I recently played <a href="https://en.wikipedia.org/wiki/Death_Stranding">Death Stranding</a> and was really inspired by the social mechanism where you‚Äôre encouraged to like everything from a car to a toadstool someone left on top of a mountain. You can also like things rapidily, though it does eventually limit you.</p>

<p>I‚Äôm very passionate about the <a href="https://en.wikipedia.org/wiki/IndieWeb">indie web</a>. <a href="https://en.wikipedia.org/wiki/Privacy_concerns_with_Facebook">Giant</a> <a href="https://en.wikipedia.org/wiki/Facebook#Criticisms_and_controversies">mega</a> <a href="https://en.wikipedia.org/wiki/Privacy_concerns_with_Google">corporations</a> <a href="https://en.wikipedia.org/wiki/Censorship_by_TikTok">want us to pretend</a> <a href="https://en.wikipedia.org/wiki/Instagram#Scientific_studies">that magic internet points mean something</a>. As static site pirates we often lose out on the magic internet points and sometimes I miss them! I built this so I can have all of the points.</p>

<h2 style="font-family: sans-serif;">No, <em>how?</em></h2>

<p><a href="https://developers.cloudflare.com/workers/">Cloudflare Workers</a> + <a href="https://developers.cloudflare.com/d1/">D1</a></p>

<p>When the image is requested, the worker increments the like count and generates the SVG. I like this approach because it loads immediately and doesn‚Äôt need any event listeners. It is completely self contained in a few lines of HTML.</p>

<p>There‚Äôs an <code class="language-plaintext highlighter-rouge">onclick</code> handler that does a <code class="language-plaintext highlighter-rouge">fetch</code> to <code class="language-plaintext highlighter-rouge">https://likes.catskull.net</code> and then updates the <code class="language-plaintext highlighter-rouge">src</code> with a timestamp to make it refresh.</p>

<p>An <code class="language-plaintext highlighter-rouge">onmouseover</code> and <code class="language-plaintext highlighter-rouge">onmouseout</code> event swap out the like count SVG for a base64 encoded SVG ‚Äúüëç Like!‚Äù. Not totally necessary but I think it‚Äôs fun!</p>

<p>Additional components could easily be created and I encourage you to make your own!</p>

<p><a href="https://github.com/catskull/likes">It's all open source, MIT License.</a></p>

<p>100% Spyware free. No analytics, no tracking. This page has Cloudflare analytics but the workers do not log or store individual requests. The URL embedding the page is stored in a private Cloudflare D1 database and isn't published anywhere. But isnt the point to let people know you're using it?</p>

<p>Additionally, it is inherintly decentralized by design. All data is public and additional hosts can be implemented with no discernable difference in quality of service or user experience.</p>

<p>üëã Thanks for stopping by and don't forget to leave a like!</p>
<img style='cursor:pointer;height:24px;'
  referrerpolicy='no-referrer-when-downgrade'
  src='https://likes.catskull.net'
  onclick="fetch('https://likes.catskull.net', {method:'POST'}).then(()=>this.src='https://likes.catskull.net'.split('?')[0]+'?t='+Date.now())"
  onmouseover="this.src='data:image/svg+xml;base64,CiAgCQkJPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjQiIHdpZHRoPSI2NCI+CiAgICAgICAgICA8cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSJ3aGl0ZSI+PC9yZWN0PgogIAkJCSAgPHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJzYW5zLXNlcmlmIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIj7wn5GNIExpa2UhPC90ZXh0PgogIAkJCTwvc3ZnPgogIAkJ'"
  onmouseout="this.src='https://likes.catskull.net?t=0'"
>

<a href="https://news.ycombinator.com/item?id=39773169">Discuss on Hacker News</a>

<p><small>PS - Likes start at 1 because I give everyone their first like üôÇ</small></p>
